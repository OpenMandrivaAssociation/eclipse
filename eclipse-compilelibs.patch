--- build.xml.compilelibs	2008-07-25 09:15:34.000000000 -0400
+++ build.xml	2008-07-25 09:15:40.000000000 -0400
@@ -1,7 +1,7 @@
 <project name="Eclipse SDK Source Build" default="run" basedir=".">
 
 	<!--  default target that runs complete build  -->
-	<target name="run" depends="fetch,insertBuildId,compile,install" />
+	<target name="run" depends="fetch,insertBuildId,compile,compilelibs,install" />
 
 	<!--  all features required to build eclipse sdk and javadoc  -->
 	<target name="allElements">
@@ -71,6 +71,33 @@
 		<record name="compilelog.txt" action="stop" />
 	</target>
 
+	<target name="compilelibs" depends="init,clean,compile" if="libsconfig">
+		<ant antfile="${buildDirectory}/plugins/org.eclipse.swt.${installWs}.${installOs}.${installArch}/build.xml" target="build.nativeLibraries" dir="${buildDirectory}/plugins/org.eclipse.swt.${installWs}.${installOs}.${installArch}" />
+	
+		<property name="launcherlibs" value="${buildDirectory}/features/org.eclipse.equinox.executable" />
+		<exec dir="${launcherlibs}/library/${installWs}/" executable="sh" failonerror="true">
+			<arg line="build.sh" />
+		</exec>
+		<copy file="${launcherlibs}/library/${installWs}/eclipse" todir="${buildDirectory}/eclipse/" />
+
+		<property name="launcherfragment" value="org.eclipse.equinox.launcher.${installWs}.${installOs}.${installArch}" />
+
+		<copy file="${launcherlibs}/library/${installWs}/eclipse" todir="features/org.eclipse.equinox.executable/contributed/${installWs}/${installOs}/${installArch}/" />
+		<copy todir="${buildDirectory}/plugins/${launcherfragment}">
+			<fileset dir="${launcherlibs}/library/${installWs}">
+				<include name="**/*.so" />
+			</fileset>
+		</copy>
+
+		<!-- build liblocalfile -->
+		<exec dir="plugins/org.eclipse.core.filesystem/natives/unix/${installOs}" executable="make" failonerror="true" />
+		<move file="plugins/org.eclipse.core.filesystem/natives/unix/${installOs}/liblocalfile_1_0_0.so" todir="plugins/org.eclipse.core.filesystem.${installOs}.${installArch}/os/${installOs}/${installArch}">
+		</move>
+		<!-- build libupdate -->
+		<ant dir="plugins/org.eclipse.update.core.${installOs}/src" antfile="build.xml" />
+
+	</target>
+
 	<!--create an installable eclipse runtime-->
 	<target name="install" depends="init">
 		<echo message="Assembling..." />
